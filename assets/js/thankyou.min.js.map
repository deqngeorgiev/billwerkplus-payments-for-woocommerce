{"version":3,"sources":["thankyou.js"],"names":["jQuery","$","window","wc_reepay_thankyou","xhr","attempts","init","this","checkPayment","err","data","status_elm","success_elm","failed_elm","state","hide","show","block","message","WC_Reepay_Thankyou","check_message","overlayCSS","background","opacity","setTimeout","location","reload","append","callback","ajax","type","url","ajax_url","action","nonce","order_id","order_key","dataType","always","unblock","done","response","document","ready"],"mappings":"AAAAA,QAAO,SAAUC,GACb,aAEAC,OAAOC,mBAAqB,CACxBC,KAAK,EACLC,SAAU,EAKVC,KAAM,WACFC,KAAKC,cAAa,SAAUC,EAAKC,GAC7B,IAAIC,EAAaV,EAAE,0BACfW,EAAcX,EAAE,kBAChBY,EAAaZ,EAAE,iBAEnB,OAAQS,EAAKI,OACT,IAAK,OACDH,EAAWI,OACXH,EAAYI,OACZ,MACJ,IAAK,SACDf,EAAE,sBAAsBgB,MAAM,CAC1BC,QAASC,mBAAmBC,cAC5BC,WAAY,CACRC,WAAY,OACZC,QAAS,MAGjBC,YAAW,WACPC,SAASC,WACV,KAEH,MACJ,IAAK,SACL,IAAK,UACDf,EAAWI,OACXF,EAAWc,OAAO,gCAAkCjB,EAAKQ,QAAU,QACnEL,EAAWG,OACX,MACJ,QAGI,GAFAd,OAAOC,mBAAmBE,WAEtBH,OAAOC,mBAAmBE,SAAW,EACrC,OAGJmB,YAAW,WACPtB,OAAOC,mBAAmBG,SAC3B,UASnBE,aAAc,SAAUoB,GASpB,OARA3B,EAAE,sBAAsBgB,MAAM,CAC1BC,QAASC,mBAAmBC,cAC5BC,WAAY,CACRC,WAAY,OACZC,QAAS,MAIVtB,EAAE4B,KAAK,CACVC,KAAM,OACNC,IAAKZ,mBAAmBa,SACxBtB,KAAM,CACFuB,OAAQ,uBACRC,MAAOf,mBAAmBe,MAC1BC,SAAUhB,mBAAmBgB,SAC7BC,UAAWjB,mBAAmBiB,WAElCC,SAAU,SACXC,QAAO,WACNrC,EAAE,sBAAsBsC,aACzBC,MAAK,SAAUC,GACdb,EAAS,KAAMa,EAAS/B,WAKpCT,EAAEyC,UAAUC,OAAM,WACdzC,OAAOC,mBAAmBG","file":"thankyou.min.js","sourcesContent":["jQuery(function ($) {\r\n    'use strict';\r\n\r\n    window.wc_reepay_thankyou = {\r\n        xhr: false,\r\n        attempts: 0,\r\n\r\n        /**\r\n         * Initialize the checking\r\n         */\r\n        init: function () {\r\n            this.checkPayment(function (err, data) {\r\n                var status_elm = $('#order-status-checking'),\r\n                    success_elm = $('#order-success'),\r\n                    failed_elm = $('#order-failed');\r\n\r\n                switch (data.state) {\r\n                    case 'paid':\r\n                        status_elm.hide();\r\n                        success_elm.show();\r\n                        break;\r\n                    case 'reload':\r\n                        $('.woocommerce-order').block({\r\n                            message: WC_Reepay_Thankyou.check_message,\r\n                            overlayCSS: {\r\n                                background: '#fff',\r\n                                opacity: 0.6\r\n                            }\r\n                        });\r\n                        setTimeout(function () {\r\n                            location.reload();\r\n                        }, 2000);\r\n\r\n                        break;\r\n                    case 'failed':\r\n                    case 'aborted':\r\n                        status_elm.hide();\r\n                        failed_elm.append('<p class=\"transaction-error\">' + data.message + \"</p>\");\r\n                        failed_elm.show();\r\n                        break;\r\n                    default:\r\n                        window.wc_reepay_thankyou.attempts++;\r\n\r\n                        if (window.wc_reepay_thankyou.attempts > 6) {\r\n                            return;\r\n                        }\r\n\r\n                        setTimeout(function () {\r\n                            window.wc_reepay_thankyou.init();\r\n                        }, 10000);\r\n                }\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Check payment\r\n         * @return {JQueryPromise<any>}\r\n         */\r\n        checkPayment: function (callback) {\r\n            $('.woocommerce-order').block({\r\n                message: WC_Reepay_Thankyou.check_message,\r\n                overlayCSS: {\r\n                    background: '#fff',\r\n                    opacity: 0.6\r\n                }\r\n            });\r\n\r\n            return $.ajax({\r\n                type: 'POST',\r\n                url: WC_Reepay_Thankyou.ajax_url,\r\n                data: {\r\n                    action: 'reepay_check_payment',\r\n                    nonce: WC_Reepay_Thankyou.nonce,\r\n                    order_id: WC_Reepay_Thankyou.order_id,\r\n                    order_key: WC_Reepay_Thankyou.order_key,\r\n                },\r\n                dataType: 'json'\r\n            }).always(function () {\r\n                $('.woocommerce-order').unblock();\r\n            }).done(function (response) {\r\n                callback(null, response.data);\r\n            });\r\n        },\r\n    };\r\n\r\n    $(document).ready(function () {\r\n        window.wc_reepay_thankyou.init();\r\n    });\r\n});\r\n"]}