if(window.wc&&window.wc.wcBlocksRegistry&&window.React&&window.wc_reepay){const e=new URL(document.currentScript.src).searchParams.get("name");if(!e)throw"Script "+document.currentScript.src+" - name is undefined";const{registerPaymentMethod:t}=wc.wcBlocksRegistry,{createElement:n,useEffect:a,useState:s,Fragment:o}=React,{useSelect:c,useDispatch:i}=wp.data,{__:r}=wp.i18n,{getSetting:l}=wc.wcSettings,{PAYMENT_STORE_KEY:d}=wc.wcBlocksData,{decodeEntities:p}=wp.htmlEntities,y=l(e+"_data",{});y.cssPath&&!document.getElementById("wc-reepay-blocks")&&document.head.insertAdjacentHTML("beforeend",`<link rel="stylesheet" href="${y.cssPath}">`);const u=p(y.title)||r("Reepay checkout","reepay-checkout-gateway");y.tokens&&y.tokens.push({id:"new"});const m=n((()=>{const[e,t]=s(0),a=y.tokens.map((a=>n(h,{token:a,activeToken:e,setActiveToken:t})));return n("ul",{className:"reepay-blocks-list"},...a,"new"===e?n("li",null,n(k)):null)})),h=({token:t,activeToken:a,setActiveToken:s})=>{const{paymentMethodData:o}=c((e=>({paymentMethodData:e(d).getPaymentMethodData()}))),{__internalSetPaymentMethodData:l}=i(d),p=`wc-${e}-payment-token`,y=t.image?n("img",{src:t.image,image_alt:t.label}):null,u=n("input",{type:"radio",name:p,id:`${p}-${t.id}`,value:t.id,checked:a===t.id,onChange:()=>{o[p]!==t.id&&(l({...o,[p]:""+t.id}),s(t.id))}}),m=n("label",{htmlFor:`wc-${e}-payment-token-${t.id}`},y,"new"===t.id?r("Use a new payment method","reepay-checkout-gateway"):`${t.masked} ${t.expiry_month}/${t.expiry_year}`);return n("li",{key:t.id,className:"reepay-blocks-list-item"},u,m)},k=()=>{const[t,a]=s(y.always_save_token||!1),{paymentMethodData:l}=c((e=>({paymentMethodData:e(d).getPaymentMethodData()}))),{__internalSetPaymentMethodData:p}=i(d),u=`wc-${e}-new-payment-method`,m=n("input",{type:"checkbox",name:u,id:u,value:!0,checked:t,disabled:y.always_save_token||!1,onChange:y.always_save_token?void 0:e=>{if(e.target.checked)p({...l,[u]:"true"});else{const e={...l};delete e[u],p(e)}a(!t)}}),h=n("label",{htmlFor:u},r("Save to account","reepay-checkout-gateway"));return n(o,{},m,h)},w=n((e=>{const{eventRegistration:t,emitResponse:n}=e,{onPaymentProcessing:s,onCheckoutAfterProcessingWithSuccess:o,onCheckoutAfterProcessingWithError:c}=t;return a((()=>{const e=s((async e=>{console.log("onPaymentProcessing",e)})),t=o((async e=>{console.log("onCheckoutAfterProcessingWithSuccess",e);const{processingResponse:t}=e,{paymentDetails:n}=t;n.reepay_id&&n.accept_url&&wc_reepay.buildModalCheckout(n.reepay_id,n.accept_url)})),n=c((async e=>{console.log("onCheckoutAfterProcessingWithSuccess",e)}));return()=>{e(),t(),n()}}),[n.responseTypes.SUCCESS,n.responseTypes.ERROR,n.responseTypes.FAIL]),y.tokens?m:p(y.description||"")}),null),g=n((e=>{const{PaymentMethodLabel:t}=e.components;return n(t,{text:u})}),null);t({name:e,label:g,content:w,edit:w,savedTokenComponent:null,canMakePayment:()=>!0,ariaLabel:u,supports:{features:Object.values(y.supports??{})}})}